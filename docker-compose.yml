version: '3.8'

services:
  firefox:
    image: ghcr.io/goyo123321/test-firefox:latest  # Firefox VNC容器镜像
    container_name: firefox                         # 容器名称
    restart: unless-stopped                         # 重启策略：除非手动停止，否则自动重启
    ports:
      - "${NOVNC_PORT:-7860}:7860"  # noVNC web访问端口（默认: 7860）
      - "${VNC_PORT:-5900}:5900"    # VNC客户端直连端口（默认: 5900）
    environment:
      - VNC_PASSWORD=${VNC_PASSWORD:-changeme}  # VNC连接密码（默认: changeme）
      - DISPLAY_WIDTH=${DISPLAY_WIDTH:-1280}    # 虚拟桌面宽度（默认: 1280）
      - DISPLAY_HEIGHT=${DISPLAY_HEIGHT:-720}   # 虚拟桌面高度（默认: 720）
      - NOVNC_PORT=${NOVNC_PORT:-7860}          # noVNC内部端口（默认: 7860）
      - VNC_PORT=${VNC_PORT:-5900}              # VNC内部端口（默认: 5900）
      - DATA_DIR=/data                          # 数据目录路径（固定值: /data）
    shm_size: "${SHM_SIZE:-1gb}"                # 共享内存大小（默认: 1GB）
    volumes:
      - firefox_data:/data/firefox              # Firefox配置文件持久化存储
      - ./downloads:/data/downloads             # 下载目录映射到宿主机当前目录下的downloads文件夹

volumes:
  firefox_data:                                 # Firefox数据卷定义
