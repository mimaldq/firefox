[supervisord]
nodaemon=true
logfile=/dev/null
logfile_maxbytes=0

; 1. 虚拟显示服务器：为Firefox提供一个虚拟的图形界面
[program:xvfb]
command=/usr/bin/Xvfb :99 -screen 0 1024x768x16 -ac +extension RANDR
autorestart=true
priority=100

; 2. VNC服务器：将虚拟显示器的内容通过VNC协议共享出来（仅限本地）
[program:x11vnc]
command=/usr/bin/x11vnc -display :99 -forever -shared -nopw -quiet -localhost
autorestart=true
priority=200

; 3. noVNC / websockify：将VNC协议转换成WebSocket，在7860端口提供Web访问
[program:novnc]
command=/usr/bin/websockify --web /usr/share/novnc 7860 localhost:5900
autorestart=true
priority=300

; 4. 你的核心Firefox自动刷新脚本
[program:firefox-refresh]
command=/home/firefoxuser/refresh.sh
autorestart=true
priority=400
user=firefoxuser
environment=DISPLAY=":99"  ; 告诉Firefox使用我们创建的虚拟显示器